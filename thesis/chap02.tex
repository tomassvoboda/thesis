\chapter{Eggan's question}

\cite{Eggan63} asks whether there are languages with arbitrarily large star height. In this section we present proof first due to~\cite{DejeanSchutzenberger66} and recently formulated in~\cite{Sakarovitch09}.

Throughout this chapter we use language $W_q = {\{f \mid |f|_a \equiv |f|_b \bmod 2^q \}}$.

\begin{thm}\label{thm:main}
    The language $W_q$ has star height~$q$.
\end{thm}

For the~proof we need to find an~expression of star height~$q$ denoting~$W_q$. That is done in~Lemma~\ref*{lm:expression_existence}. Then it remains to show that $W_q$ has the star height of at~least~$q$.

\begin{lemma}\label{lm:expression_existence}
    For each $q \in \N$ there is an expression of star height~$q$, that denotes~$W_q$.
\end{lemma}

\begin{proof}
    $W_q$ is recognised by an automaton~${\mathcal{R}(2^q)}$. By following a specific order~$\omega$ in the elimination method on $W_q$ we get an expression of a~star height $q$. First we set expressions
    \begin{alignat*}{5}
        X_1 = a^2 , \quad Y_1 = b^2, \quad &\text{ and } \quad Z_1 = ab + ba.
    \intertext{Then for every integer $n$ we have}
        X_{n+1} = X_n Z_n^* X_n , \quad Y_{n+1} = Y_n Z_n^* Y_n, \quad &\text{ and } \quad Z_{n+1} = Z_n + X_n Z_n^* Y_n + Y_n Z_n^* X_n.
    \end{alignat*}
    It follows that
    \[
        W_q = {(X_q + Y_q + Z_q)}^*.
    \]
    Since $X_n , Y_n , \text{ and } Z_n$ have star height~$n~-~1$, we have got an~expression denoting~$W_q$ of star height~$q$.
\end{proof}

\begin{example}
    Let us have language~$W_3$ recognised by an automaton~${\mathcal{R}(8)}$. In~\autoref*{fig:automaton_R8_state_removal_steps} we show how the~state removal algorithm finds the~expression of star height~$3$ that denotes~$W_3$. For the expression at the end of the algorithm we can see following equivalence:
    \[
        {(Z_2 + {(X_2 + Y_2)}Z_2^*{(X_2 + Y_2)})}^* = {(X_3 + Y_3 + Z_3)}^* = W_3.
    \]
\end{example}

\begin{figure}%
    \centering
    \subfloat[][]{%
        \label{fig:automaton_R8_state_removal_steps-a}%
        \input{./figures/automaton_R8_removed1}}%
    \hspace{70pt}%
    \subfloat[][]{%
        \label{fig:automaton_R8_state_removal_steps-b}%
        \input{./figures/automaton_R8_removed2}}\\
    \subfloat[][]{%
        \label{fig:automaton_R8_state_removal_steps-c}%
        \input{./figures/automaton_R8_removed3}}%
    \hspace{8pt}%
    \subfloat[][]{%
        \label{fig:automaton_R8_state_removal_steps-d}%
        \input{./figures/automaton_R8_removed4}}\\
    \subfloat[][]{%
        \label{fig:automaton_R8_state_removal_steps-e}%
        \input{./figures/automaton_R8_removed5}}\\
    \subfloat[][]{%
        \label{fig:automaton_R8_state_removal_steps-e}%
        \input{./figures/automaton_R8_removed6}}%
    \hspace{20pt}%
    \subfloat[][]{%
        \label{fig:automaton_R8_state_removal_steps-e}%
        \input{./figures/automaton_R8_removed7}}%
    \caption{First through seventh steps of the~state removal algorithm with order~$\omega$}%
    \label{fig:automaton_R8_state_removal_steps}%
\end{figure}

\begin{proof}[Proof of \autoref*{thm:main}]
\end{proof}