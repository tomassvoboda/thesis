\chapter{Introduction}

In the first section we state same definitions that are considered standard and lay down notation that is used later in the work. In the second section we provide some additional definitions and observations that are more specific to the presented problem.

\section{Basic definitions \& notation}

\begin{defn} \X{List of definitions and notation that need to be introduced:}\\
    \X{``word is a factor of language''}\\
    \X{Automaton, finite automaton, automaton equivalence, generalised automaton}
\end{defn}

\begin{defn}
    \X{Expression, expression equivalence, star height (of expression, of language)}
\end{defn}

\X{Should the heavy inspiration for the following sections, taken from~\cite{Sakarovitch09}, be explicitly stated here?}

\section{Words and languages}

An \emph{alphabet} is a non-empty, usually finite, set of symbols. Let $A$ be an alphabet. The elements of $A$, the symbols, are called \emph{letters}, and finite sequences of letters are called \emph{words}. The set of words, sequences of letters of A, is written $A^*$. \X{Should a reason for this notation be given?} Word $f$ can therefore be written
\[
    f = (a_1, a_2, \dotsc, a_n),
\]
with $a_i$ in $A$, $1 \leq i \leq n$. \emph{Product} on the set of words is equivalent to the operation of concatenation:
\[
    (a_1, \dotsc, a_n) \cdot (b_1, \dotsc, b_m) = (a_1, \dotsc, a_n, b_1, \dotsc, b_m).
\]
This operation has a neutral element: the empty sequence or empty word, which is written $1$, or $1_{A^*}$ if there could be some ambiguity. Note, that concatenation is associative, but it is not commutative. The definition of product implies that each word is a product of its letters and therefore can be written
\[
    f = (a_1, a_2, \dotsc, a_n) = (a_1) \cdot (a_2) \dotsm (a_n).
\]
By identifying the sequence $(a)$ with the word $a$ and omitting the explicit symbol for product, we are able to write the word $f$ as
\[
    f = a_1 a_2 \dotsm a_n.
\]
Similarly for the product of two words $f$ and $g$ we write $fg$.

\subsubsection*{Length}

The \emph{length} of a word is the length of the sequence of letters the word contains. The length of $f = a_1 a_2 \dotsm a_n$ is $n$. It is written $|f|$. For the number of occurrences of the letter $a$ in $f$ we write $|f|_a$. If $f$ is a word in $A^*$ we then have
\[
    |f| = \sum_{a \in A} |f|_a.
\]

\subsubsection*{Factors}

Let $f, g, h$ and $u$ be words in $A^*$. Word $g$ is a \emph{left factor} or \emph{prefix} of $f$ if there exists $h$ such that $f = g h$. Word $h$ is a \emph{right factor} or \emph{suffix} of $f$ if there exists $g$ such that $f = g h$. Word $u$ is a factor of $f$ if there exist $g$ and $h$ such that $f = g u h$.

\subsubsection*{Languages}

A \emph{language over $A$}, or \emph{language of $A^*$}, is any set of words written in the alphabet $A$. In other words, a language of $A^*$ is a subset of $A^*$. A language is therefore an element of $\ps{A^*}$, the set of all the subsets of $A^*$. We can thus naturally define for languages all the usual operations on the subsets of a set: union, intersection, complement and difference, with the usual notation.

\section{Rational expressions}

Let $A$ be an alphabet and let $\{0, 1, +, \cdot, *\}$ be five function symbols. Constants $0$ and $1$ are nullary operations, $+$ and $\cdot$ are binary, and $*$ is unary.

\begin{defn}
    \emph{A rational expression over $A$} is a formula obtained inductively from the letters of $A$ and the functions $\{0, 1, +, \cdot, *\}$ by the following process:
    \begin{itemize}
        \item[(i)] $0, 1$, and $a$, for $a$ in $A$, are rational expressions,
        \item[(ii)] if $\re{E}$ and $\re{F}$ are rational expressions, then $(\re{E} + \re{F})$, $(\re{E} \cdot \re{F})$, and $\re{E}^*$ are rational expressions.
    \end{itemize}
    We write $\re{RatE} A^*$ for the set of rational expressions over $A$.
\end{defn}

\begin{lemma}\label{lm:star_height_distributivity}
    Every language $L$ over $A$ with star height~$h$ is denoted by a finite sum of expressions:
    \[
        L = \sum_{j=1}^n \mathsf{E}_j,
    \]
    where each $\mathsf{E}_j$ if product of the form:
    \[
        \mathsf{E}_j = u_0{(\mathsf{F}_1)}^*u_1 \dotsm u_{m-1}{(\mathsf{F}_m)}^*u_m,
    \]
    where each $u_k, 0 \leq k \leq m$, is a word in $A^*$ and each $\mathsf{E}_j, 1 \leq k \leq m$, is an expression over $A$ of star height less then or equal to $h-1$.
\end{lemma}

\begin{proof}
    By induction on $h$. For language of star height 1 the fact that sum distributes over product gives us the result immediately. \X{Finish the proof.}
\end{proof}

\begin{lemma}\label{lm:block_star_lemma}
    Let $L$ be a recognisable language over $A$. There exists $N \in \N$ that for every word $f$ in $L$ and every factorisation of the form
    \[
        f = u v_1 v_2 \dotsm v_N w \; , \quad \text{where every $v_i$ is a non-empty word.}
    \]
    Then there is a pair $(j,k)$ of indices, $0 \leq j < k \leq N$, that
    \[
        u v_1 v_2 \dotsm v_j {(v_{j+1} \dotsm v_k)}^* v_{k+1} \dotsm v_N w \subseteq L.
    \]
\end{lemma}

\subsection{State removal algorithm}

State removal algorithm takes provided finite automaton and derives a~rational expression that denotes the same language as is accepted by the original automaton. Let $\mathcal{A}~=~\langle Q, A, E, I, T \rangle$ be the provided automaton. Next, we construct an~automaton $\mathcal{B}$, from $\mathcal{A}$, by adding two states $i$ and $t$, distinct and not belonging to $Q$, a spontaneous transition from $i$ to each initial state of $\mathcal{A}$, and a spontaneous transition from each final state of $\mathcal{A}$ to $t$. We consider the state $i$ to be the only initial state, and $t$ the only final state, of automaton $\mathcal{B}$. Clearly $\mathcal{A}$ and $\mathcal{B}$ are equivalent and since $\mathcal{A}$ is finite, $\mathcal{B}$ is also finite.

Next part of the algorithm has as many steps as there are states in $Q$. In each step we remove a state in $Q$ from $\mathcal{B}$ and modify the transitions in a way that the derived automaton is equivalent to that of the previous step. Let $q$ be a~particular state in $Q$, let $p_1, \dotsc , p_k$ be states of $\mathcal{B}$, $p_j \neq q$, that are the sources of transitions which have $q$ as a destination, and $\re{E}_1, \dotsc , \re{E}_k$ the labels of these transitions. And let $r_1, \dotsc , r_l$ be states of $\mathcal{B}$, $r_j \neq q$, that are the destinations of transitions whose source is $q$, and $\re{G}_1, \dotsc , \re{G}_l$ the labels of these transitions. Note that some states $p_j$ can be the same as states $r_m$. If there is a transition with source and destination $q$, we will denote it by $\re{F}$. Otherwise we set $\re{F} = 0$ and therefore we have $\re{F}^* = 1$.

Let $\mathcal{B}'$ be an automaton obtained from $\mathcal{B}$ by first removing the state $q$ and all of the following transitions described above
\[
    (p_1, \re{E}_1, q), \dotsc, (p_k, \re{E}_k, q), (q, \re{G}_1, r_1), \dotsc, (q, \re{G}_l, r_l), (q, \re{F}, q),
\]
and second by adding, for each pair of states $(p_h, r_j)$, $1 \leq h \leq k$ and $1 \leq j \leq l$, the transition $(p_h, \re{E}_h \re{F}^* \re{G}_j, r_j)$.

\section{\X{Additional definitions}}

\begin{defn}
    Let $A = {\{a,b\}}$. An automaton $\langle \Z_n, A, E, 0, 0 \rangle$ is called \emph{ring automaton~${\mathcal{R}(n)}$}, if for each state $z \in \Z_n$ there are exactly two transitions with $z$ as a~source and they are $(z, a, z+1)$ and $(z, b, z-1)$.
\end{defn}

\begin{example}
    \autoref*{fig:automaton_R8} shows ring automaton~${\mathcal{R}(8)}$.

    \begin{figure}[h]
        \centering
        \input{./figures/automaton_R8}
        \caption{Automaton~${\mathcal{R}(8)}$}\label{fig:automaton_R8}
    \end{figure}
\end{example}