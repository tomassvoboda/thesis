\chapter{Introduction}

In the first section we state same definitions that are considered standard and lay down notation that is used later in the work. In the second section we provide some additional definitions and observations that are more specific to the presented problem.

\X{Should the heavy inspiration for the following sections, drawn from~\cite{Sakarovitch09}, be explicitly stated here?}

\section{Words and languages}

An \emph{alphabet} is a non-empty, usually finite, set of symbols. Let $A$ be an alphabet. The elements of $A$, the symbols, are called \emph{letters}, and finite sequences of letters are called \emph{words}. The set of words, sequences of letters of A, is written $A^*$ for reasons that should later become obvious. Word $f$ can therefore be written
\[
    f = (a_1, a_2, \dotsc, a_n),
\]
with $a_i$ in $A$, $1 \leq i \leq n$.

\subsubsection*{Product}

\emph{Product} on the set of words is equivalent to the operation of concatenation:
\[
    (a_1, \dotsc, a_n) \cdot (b_1, \dotsc, b_m) = (a_1, \dotsc, a_n, b_1, \dotsc, b_m).
\]
This operation has a neutral element: the empty sequence or empty word, which is written $1$, or $1_{A^*}$ if there could be some ambiguity. Note, that concatenation is associative, but it is not commutative. The definition of product implies that each word is a product of its letters and therefore can be written
\[
    f = (a_1, a_2, \dotsc, a_n) = (a_1) \cdot (a_2) \dotsm (a_n).
\]
By identifying the sequence $(a)$ with the word $a$ and omitting the explicit symbol for product, we are able to write the word $f$ as
\[
    f = a_1 a_2 \dotsm a_n.
\]
Similarly for the product of two words $f$ and $g$ we write $fg$.

\subsubsection*{Length}

The \emph{length} of a word is the length of the sequence of letters the word contains. The length of $f = a_1 a_2 \dotsm a_n$ is $n$. It is written $|f|$. For the number of occurrences of the letter $a$ in $f$ we write $|f|_a$. If $f$ is a word in $A^*$ we then have
\[
    |f| = \sum_{a \in A} |f|_a \; .
\]

\subsubsection*{Factors}

Let $f, g, h$ and $u$ be words in $A^*$. Word $g$ is a \emph{left factor} or \emph{prefix} of $f$ if there exists $h$ such that $f = g h$. Word $h$ is a \emph{right factor} or \emph{suffix} of $f$ if there exists $g$ such that $f = g h$. Word $u$ is a factor of $f$ if there exist $g$ and $h$ such that $f = g u h$.

\subsubsection*{Languages}

A \emph{language over $A$}, or \emph{language of $A^*$}, is any set of words written in the alphabet $A$. In other words, a language of $A^*$ is a subset of $A^*$. A language is therefore an element of $\ps{A^*}$, the set of all the subsets of $A^*$. We can thus naturally define for languages all the usual operations on the subsets of a set: union, intersection, complement and difference, with the usual notation.

Word $f$ is \emph{a factor of language $L$}, if it is a factor of some word $g$ in $L$.

The product of words extends to a product of languages, which is denoted, as in the case of words, by a dot, $X \cdot Y$, or by simple concatenation, $X Y$:
\[
    X \cdot Y = \{ f \cdot g \mid f \in X \, , \; g \in Y \}.
\]
From this we obtain, by induction on $n$, the definition of the $n$th power of $X$, for all $X$ in $\ps{A^*}$:
\begin{align*}
    X^0 &= \{1_{A^*}\} \: ,\\
    X^{n+1} &= X \cdot X^n = X^n \cdot X.
\end{align*}

The star of a language $X$ is the union of all the powers of $X$, and is written as $X^*$:
\[
    X^* = \bigcup_{n \in \N} X^n.
\]

\section{Rational expressions}

Let $A$ be an alphabet and let $\{0, 1, +, \cdot, *\}$ be five function symbols. Constants $0$ and $1$ are nullary operations, $+$ and $\cdot$ are binary, and $*$ is unary.

\begin{defn}
    \emph{A rational expression over $A$} is a formula obtained inductively from the letters of $A$ and the functions $\{0, 1, +, \cdot, *\}$ by the following process:
    \begin{itemize}
        \item[(i)] $0, 1$, and $a$, for $a$ in $A$, are rational expressions,
        \item[(ii)] if $\re{E}$ and $\re{F}$ are rational expressions, then $(\re{E} + \re{F})$, $(\re{E} \cdot \re{F})$, and $(\re{E}^*)$ are rational expressions.
    \end{itemize}
    We write $\re{RatE} A^*$ for the set of rational expressions over $A$.
\end{defn}

To be able to simplify the notation by omitting the parentheses in the rational expressions, we need to specify the order of operator precedence for $+, \: \cdot \:$, and $*$. We say that $*$ takes precedence over $\cdot$ which takes precedence over $+$. With this convention we write, for example,
\begin{align*}
    &ab + ba & &\text{for} & &((a \cdot b) + (b \cdot a)), \; \text{or}\\
    &{(a + b \cdot ({((a \cdot b^* ) \cdot a)}^* \cdot b))}^* & &\text{for} & &({(a + (b \cdot (({((a \cdot (b^*)) \cdot a)}^* ) \cdot b)))}^* ) .
\end{align*}

\begin{defn}
    To each rational expression $\re{E}$ in $\re{RatE} A^*$ we assign a corresponding language of $A^*$, written $L[\re{E}]$, and defined inductively:
    \[
            L[0] = \emptyset \, , \quad L[1] = \{1_{A*}\} \, , \quad \text{and} \quad L[a] = \{a\} \quad \text{for all $a$ in $A$}
    \]
    for the atomic rational expressions and then for the composite rational expressions:
    \[
        L[\re{E} + \re{F}] = L[\re{E}] \cup L[\re{F}] \; , \quad L[\re{E} \cdot \re{F}] = L[\re{E}] \cdot L[\re{E}] \; , \quad L[\re{E}^*] = {(L[\re{E}])}^*.
    \]
    We say that $\re{E}$ \emph{denotes} the language $L[\re{E}]$.
\end{defn}

We say that a language of $A^*$ is \emph{rational} if and only if it is denoted by a rational expression over $A$.

Two rational expressions are \emph{equivalent} if they denote the same language. That means $\re{E}$ and $\re{F}$ are equivalent if $L[\re{E}] = L[\re{F}]$ and we write it as $\re{E} = \re{F}$.

\section{Star height}

Of all the operators defined for rational expressions, $*$ is the only one that `gives access to the infinite'. Hence the idea of measuring the complexity of expressions by counting the number of nested uses of this operator, a number which is called the \emph{star height}, which we will write $\h{\re{E}}$, for $\re{E} \in \re{RatE} A^*$, and which is defined by induction:
\begin{align*}
    &\text{if } \re{E} = 0, \re{E} = 1 \text{ or } \re{E} = a, \text{ for } a \in A \; , & &\h{\re{E}} = 0 \; , \\
    &\text{if } \re{E} = \re{F} + \re{G} \text{ or } \re{E} = \re{F} \cdot \re{G}\; , & &\h{\re{E}} = \max{(\h{\re{F}}, \h{\re{G}})} \; , \\
    &\text{if } \re{E} = \re{F}^* \; , & &\h{\re{E}} = 1 + \h{\re{F}} \; .
\end{align*}

The star height of a rational language $L$ over $A^*$, written $\h{L}$, is the minimum of the star heights of the rational expressions that denote $L$:
\[
    \h{L} = \min \{ \h{\re{E}} \mid \re{E} \in \re{RatE} A^*: L[\re{E}] \} \; .
\]

\begin{lemma}\label{lm:star_height_distributivity}
    Every language $L$ over $A$ with star height~$h$ is denoted by a finite sum of rational expressions:
    \[
        L = L \left[ \, \sum_{j=1}^n \re{E}_j \right] ,
    \]
    where each $\re{E}_j$ if product of the form:
    \[
        \re{E}_j = u_0{(\re{F}_1)}^*u_1 \dotsm u_{m-1}{(\re{F}_m)}^*u_m,
    \]
    where each $u_k, 0 \leq k \leq m$, is a word in $A^*$ and each $\re{F}_k, 1 \leq k \leq m$, is a rational expression over $A$ of star height less then or equal to $h-1$.
\end{lemma}

\begin{proof}
    By induction on $h$, follows from the fact that product distributes over sum. \X{Sufficient?}
\end{proof}

\section{Automata}

An automaton is a \emph{directed graph} which is \emph{labelled} with rational expressions over an alphabet, and in which two subsets of vertices are distinguished.

\begin{defn}
    An automaton $\aut{A}$ is specified by giving the following elements:
    \begin{itemize}
        \item[(i)] a non-empty set $Q$, called the set of \emph{states} of $\aut{A}$,
        \item[(ii)] a set $A$, also non-empty, called the \emph{(input) alphabet} of $\aut{A}$,
        \item[(iii)] a subset $I$ of $Q$, called the set of \emph{initial states}, of $\aut{A}$,
        \item[(iv)] a subset $T$ of $Q$, called the set of \emph{final states} of $\aut{A}$,
        \item[(v)] a subset $E$ of $Q \times \re{RatE} A^* \times Q$, called the set of \emph{transitions} of $\aut{A}$.
    \end{itemize}
    We write $\aut{A} = \langle Q, A, E, I, T \rangle$ and we say that $\aut{A}$ is \emph{an automaton over $A$}.
\end{defn}

When referencing any of the elements definning an automaton, we use subscript to differentiate between the automata. For example, a set of states of automaton $\aut{A}$ is written as $Q_{\aut{A}}$, and set of transitions of automaton $\aut{B}$ is written as $E_{\aut{B}}$.

Let $A$ be a finite alphabet. We call an automaton over $A$ \emph{finite} if set its states is finite.

If $e = (p, \re{E}, q)$ is a transition of $\aut{A}$, that is, if $e$ is in $E$, we say that $\re{E}$ is the \emph{label} of $e$ and we will write $p \tr{\re{E}} q$, or $p \tr[\aut{A}]{\re{E}} q$ where it might be ambiguous which automaton we are considering. We also say that $p$ is the \emph{source} and $q$ the \emph{destination} of the transition $e$. Transition is a \emph{loop}, if its source and destination are the same state.

Note that we can always assume that there is, between each pair of states of an automaton, \emph{at most one transition}. This is because we chose rational expressions as the labels of transitions, rather than just the letters of $A$, as is usual. The judiciousness of our generalisation has to do with fundamental result, known as Kleeneâ€™s Theorem, due to~\cite{Kleene56}.

A \emph{computation} $c$ in $A$ is a sequence of transitions where the source of each is the destination of the previous one, which can be written:
\[
    p_0 \tr{\re{E}_1} p_1 \tr{\re{E}_2} p_2 \dotsm p_{n-1} \tr{\re{E}_n} p_n,
\]
or
\[
    p_0 \tr{\re{E}_1 \re{E}_2 \dotsm \re{E}_n} p_n.
\]
The state $p_0$ is the \emph{source} of the computation $c$, and $p_n$ its \emph{destination}. The \emph{length} of the computation $c$ is $n$, the number of transitions which make up $c$. The \emph{label} of $c$ is the product of the labels of the transitions of $c$. In the above case, the label of $c$ is $\re{E}_1 \re{E}_2 \dotsm \re{E}_n$.

A computation in $\aut{A}$ is successful if its source is an initial state and its destination is a final state. A word in $A^*$ is called \emph{accepted} or \emph{recognised} by $\aut{A}$ if it is in a language denoted by a label of a successful computation in $\aut{A}$.

\begin{defn}
    The language accepted, or recognised by $\aut{A}$, written $L(\aut{A})$, is the set of words \emph{accepted} (or \emph{recognised}) by $\aut{A}$:
    \[
        L(\aut{A}) = \{ f \in A^* \mid \; \exists \: i \in I \: , \; \exists \: t \in T : \: i \tr[\aut{A}]{\re{E}} t \; \wedge \; f \in L[\re{E}] \}.
    \]
\end{defn}

Two automata are \emph{equivalent} if they recognise the same language.

\begin{lemma}\label{lm:block_star_lemma}
    Let $L$ be a recognisable language over $A$. There exists $N \in \N$ that for every word $f$ in $L$ and every factorisation of the form $f = u v_1 v_2 \dotsm v_N w$, where every $v_i$ is a non-empty word, there is a pair $(j,k)$ of indices, $0 \leq j < k \leq N$, that
    \[
        u v_1 v_2 \dotsm v_j {(v_{j+1} \dotsm v_k)}^* v_{k+1} \dotsm v_N w \subseteq L.
    \]
\end{lemma}

\begin{proof}
    Let $\aut{A} = \langle Q, A, E, I, T \rangle$ be an automaton that recognises $L$. Set $N = |Q|$, meaning $N$ is a size of the set $Q$. A computation that accepts $f$ can be written
    \[
        i \tr{\re{E}} q_0 \tr{\re{F}_1} q_1 \tr{\re{F}_2} q_2 \tr{\re{F}_3} \dotsm \tr{\re{F}_{N-1}} q_{N-1} \tr{\re{F}_{N}} q_N \tr{\re{G}} t,
    \]
    where $u \in L[\re{E}], \; v_i \in L[\re{F}_i], $ for $ 1 \leq i \leq N$, and $w \in L[\re{G}]$. The $N + 1$ states $q_i$ cannot all be distinct, and at least two, say $q_j$ and $q_k$, are equal to the same state $p$. The computation can therefore be written
    \[
        i \tr{\re{E}} q_0 \tr{\re{F}_1 \re{F}_2 \dotsm \re{F}_j} p \tr{\re{F}_{j+1} \dotsm \re{F}_k} p \tr{\re{F}_{k+1} \dotsm \re{F}_N} q_N \tr{\re{G}} t,
    \]
    where $L[\re{F}_{j+1} \dotsm \re{F}_k]$ contains the non-empty word $v_{j+1} \dotsm v_k$. Hence, for every integer $n$,
    \[
        i \tr{\re{E}} q_0 \tr{\re{F}_1 \re{F}_2 \dotsm \re{F}_j} p \tr{{(\re{F}_{j+1} \dotsm \re{F}_k)}^n} p \tr{\re{F}_{k+1} \dotsm \re{F}_N} q_N \tr{\re{G}} t,
    \]
    is a successful computation of $\aut{A}$ and $u v_1 v_2 \dotsm v_j {(v_{j+1} \dotsm v_k)}^n v_{k+1} \dotsm v_N w$ is accepted by $\aut{A}$.
\end{proof}

\begin{defn}
    Automaton $\langle \Z_n, \{a,b\}, E, \{0\}, \{0\} \rangle$ is called \emph{ring automaton~${\aut{R}(n)}$}, if for each state $z \in \Z_n$ there are exactly two transitions with $z$ as a~source and they are $(z, a, z+1)$ and $(z, b, z-1)$.
\end{defn}

\begin{example}
    \autoref*{fig:automaton_R8} shows ring automaton~${\aut{R}(8)}$.

    \begin{figure}[h]
        \centering
        \input{./figures/automaton_R8}
        \caption{Automaton~${\aut{R}(8)}$}\label{fig:automaton_R8}
    \end{figure}
\end{example}

\subsection{State removal algorithm}

State removal algorithm takes $\aut{A}$, a~provided finite automaton, and derives a~rational expression that denotes $L(\aut{A})$, the language accepted by the original automaton. First we construct an~automaton $\aut{B}$ from $\aut{A}$. That is done by adding two states $i$ and $t$, distinct and not belonging to $Q_{\aut{A}}$, a spontaneous transition from $i$ to each initial state of $\aut{A}$, and a spontaneous transition from each final state of $\aut{A}$ to $t$. We set $I_{\aut{B}} = \{i\}$ and $T_{\aut{B}} = \{t\}$. Clearly $\aut{A}$ and $\aut{B}$ are equivalent and since $\aut{A}$ is finite, $\aut{B}$ is also finite. Let us also set $\aut{B}_0 = \aut{B}$.

Next part of the algorithm has as many steps as there are states in $Q_{\aut{A}}$. Let $N = |Q_{\aut{A}}|$. In $j$th step we take an automaton $\aut{B}_{j-1}$ and create $\aut{B}_j$. Let $q$ be a~particular state in $\aut{B}_{j-1}$ that is also in $\aut{A}$. Next, let $p_1, \dotsc , p_k$ be states of $\aut{B}_{j-1}$, distinct from $q$, that are sources of transitions which have $q$ as its destination, and let $\re{E}_1, \dotsc , \re{E}_k$ be labels of these transitions. Similarly for the transitions leaving the state $q$, we let $r_1, \dotsc , r_l$ be states of $\aut{B}_{j-1}$, distinct from $q$, that are the destinations of transitions whose source is $q$, and let $\re{G}_1, \dotsc , \re{G}_l$ be labels of these transitions. Note that some $p_m$ can be the same as some $r_n$. If $q$ has a loop, we will denote it by $\re{F}$. Otherwise we set $\re{F} = 0$.

Consider the automaton $\aut{B}_{j-1}$. We first remove the state $q$ and all of the following transitions described above:
\[
    (p_1, \re{E}_1, q), \dotsc, (p_k, \re{E}_k, q), (q, \re{G}_1, r_1), \dotsc, (q, \re{G}_l, r_l), (q, \re{F}, q).
\]
Second, for each pair of states $(p_m, r_n)$, $1 \leq m \leq k$ and $1 \leq n \leq l$, we look if there is a transition from $p_m$ to $r_n$ in $\aut{B}_{j-1}$. If it is, we denote its label by $\re{H}$ and we remove that transition, $(p_m, \re{H}, r_n)$, from $\aut{B}_{j-1}$, otherwise we set $\re{H} = 0$. We then finally add the transition $(p_m, \re{H} + \re{E}_m \re{F}^* \re{G}_n, r_n)$ to $\aut{B}_{j-1}$. After traversing all of $k l$ state pairs, we obtain the automaton $\aut{B}_j$.

At the end we are left with automaton $\aut{B}_N$. It has three states and three transitions. The states are $i, t$, and $q$, and the transitions are $(i, 1, q), (q, \re{E}, q)$, and $(q, 1, t)$, where $\re{E}$ is a rational expression that denotes $L(\aut{A})$.