\chapter{Introduction}

Kleene~\cite{Kleene56}, in result known as Kleene’s Theorem, shows that automata and expressions correspond to each other and characterise the same class of languages. Eggan~\cite{Eggan63} refines this result by defining a measure of complexity for both of them: loop complexity for automata and star height for expressions, and by showing they correspond to each other by characterising the same classes of languages. In this thesis we limit ourselves to the presentation of star height, and to the proof, due to Dejean and Schützenberger~\cite{DejeanSchutzenberger66}, which states that the star height hierarchy is infinite. They show that for any integer $k \leq 0$, there exists a~rational language of star height $k$ over two letter alphabet. We end by touching on another notion, the generalised star height, which may divide the family of rational languages into only two parts.

The determination of the star height of a~language turns out to be one of the most difficult problems in automata theory. McNaughton~\cite{McNaughton67} presented first notable result, an~algorithm for finding the star height of certain family of languages, so called \emph{pure-group languages}. Hashiguchi first~\cite{Hashiguchi1982} provided an~algorithm for deciding whether or not an~arbitrary rational language is of star height one and then~\cite{Hashiguchi1988}, after six years, an~algorithm to determine the star height of any rational language. The algorithm for the general case was not practical, being of non-\textsc{ELEMENTARY} complexity class. Kirsten~\cite{Kirsten05} devised a~more efficient algorithm than Hashiguchi's, decidable in $2^{2^{\aut{O}(n)}}$ space.

In the rest of this chapter we introduce some standard concepts such as words, languages, rational expressions, and automata, but we also make a few key modifications to simplify the proofs in the next chapter, therefore justifying this rather lengthy introduction.

\section{Words and languages}

An \emph{alphabet} is a non-empty, usually finite, set of symbols. Let $A$ be an alphabet. The elements of $A$, the symbols, are called \emph{letters}, and finite sequences of letters are called \emph{words}. The set of words, sequences of letters of $A$, is written $A^*$ for reasons that should later become obvious. Word $f$ can therefore be written
\[
    f = (a_1, a_2, \dotsc, a_n),
\]
with $a_i$ in $A$, $1 \leq i \leq n$.

\subsubsection*{Product}

\emph{Product} on the set of words is equivalent to the operation of concatenation:
\[
    (a_1, \dotsc, a_n) \cdot (b_1, \dotsc, b_m) = (a_1, \dotsc, a_n, b_1, \dotsc, b_m).
\]
This operation has a neutral element: the empty sequence or empty word, which is written $1$, or $1_{A^*}$ if there could be some ambiguity. Note, that concatenation is associative, but it is not commutative. The definition of product implies that each word is a product of its letters and therefore can be written
\[
    f = (a_1, a_2, \dotsc, a_n) = (a_1) \cdot (a_2) \dotsm (a_n).
\]
By identifying the sequence $(a)$ with the letter $a$ and omitting the explicit symbol for product, we are able to write the word $f$ as
\[
    f = a_1 a_2 \dotsm a_n.
\]
Similarly for the product of two words $f$ and $g$ we write $fg$.

\subsubsection*{Length}

The \emph{length} of a word is the length of the sequence of letters the word contains. Let $a_1, a_2, \dotsc, a_n$ be letters. Then the length of a word $f = a_1 a_2 \dotsm a_n$ is $n$. It is written $|f|$. For the number of occurrences of the letter $a$ in $f$ we write $|f|_a$. If $f$ is a word in $A^*$ we then have
\[
    |f| = \sum_{a \in A} |f|_a \; .
\]

\subsubsection*{Factors}

Let $f, g, h$ and $u$ be words in $A^*$. Word $g$ is a \emph{left factor} or \emph{prefix} of $f$ if there exists $h$ such that $f = g h$ and $g$ is a \emph{proper left factor} or \emph{proper prefix} if $h$ is other than the empty word. Word $h$ is a \emph{right factor} or \emph{suffix} of $f$ if there exists $g$ such that $f = g h$ and $h$ is a \emph{proper right factor} or \emph{proper suffix} if $g$ is other than the empty word. Word $u$ is a factor of $f$ if there exist $g$ and $h$ such that $f = g u h$ and $u$ is a \emph{proper factor} if $g$ and $h$ are not both equal to the empty word.

\subsubsection*{Languages}

A \emph{language over $A$}, or \emph{language of $A^*$}, is any set of words written in the alphabet $A$. In other words, a language of $A^*$ is a subset of $A^*$, therefore an element of $\ps{A^*}$, the set of all the subsets of $A^*$. We can thus naturally define for languages all the usual operations on the subsets of a set: union, intersection, complement and difference, with the usual notation.

Word $f$ is \emph{a factor of language $L$}, if it is a factor of some word $g$ in $L$.

The product of words extends to a product of languages, which is denoted, as in the case of words, by a dot, $X \cdot Y$, or by simple concatenation, $X Y$:
\[
    X \cdot Y = \{ f \cdot g \mid f \in X \, , \; g \in Y \}.
\]
From this we obtain, by induction on $n$, the definition of the $n$th power of $X$, for all $X$ in $\ps{A^*}$:
\begin{align*}
    X^0 &= \{1_{A^*}\} \: ,\\
    X^{n+1} &= X \cdot X^n = X^n \cdot X.
\end{align*}
Note that even for $\emptyset \in \ps{A^*}$ we get $\emptyset^0 = \{1_{A^*}\}$.

The star of a language $X$ is the union of all the powers of $X$, and is written as $X^*$:
\[
    X^* = \bigcup_{n \in \N} X^n.
\]

Note that the notation $X^*$ is somewhat improper because in this context $X^*$ does not denote the set of all words over $X$ but the set of products of elements of $X$. Nevertheless, if one takes $X = A$, the impropriety vanishes: the set of products of elements of an alphabet $A$ is indeed equal to the set of all words generated by $A$.

\section{Rational expressions}

Let $A$ be an alphabet and let $\{\re{0}, \re{1}, +, \cdot, *\}$ be five function symbols.

\begin{defn}
    \emph{A rational expression over $A$} is a formula obtained inductively from the letters of $A$ and the symbols $\{\re{0}, \re{1}, +, \cdot, *\}$ by the following process:
    \begin{itemize}
        \item[(i)] $\re{0}, \re{1}$, and $a$, for $a$ in $A$, are rational expressions,
        \item[(ii)] if $\re{E}$ and $\re{F}$ are rational expressions, then $(\re{E} + \re{F})$, $(\re{E} \cdot \re{F})$, and $(\re{E}^*)$ are rational expressions.
    \end{itemize}
    We write $\re{RatE} A^*$ for the set of rational expressions over $A$.
\end{defn}

To be able to simplify the notation, we can think of the function symbols as symbols representing operations and we can omit the parentheses in the rational expressions if we specify the order of precedence for $+, \: \cdot \:$, and $*$. We let $*$ take precedence over $\cdot \:$, which in turn takes precedence over $+ \:$. As with letters in words, we omit the symbol $\cdot \:$. With this convention we write, for example,
\begin{align*}
    &ab + ba & &\text{for} & &((a \cdot b) + (b \cdot a)), \; \text{or}\\
    &{(a + b \, {(a b^* a)}^* b)}^* & &\text{for} & &({(a + (b \cdot (({((a \cdot (b^*)) \cdot a)}^* ) \cdot b)))}^* ) .
\end{align*}

\begin{defn}
    To each rational expression $\re{E}$ in $\re{RatE} A^*$ we assign a language of $A^*$, written $L[\re{E}]$, and defined inductively:
    \[
            L[\re{0}] = \emptyset \, , \quad L[\re{1}] = \{1_{A^*}\} \, , \quad \text{and} \quad L[a] = \{a\} \quad \text{for all $a$ in $A$}
    \]
    for the atomic rational expressions and then for the composite rational expressions:
    \[
        L[\re{E} + \re{F}] = L[\re{E}] \cup L[\re{F}] \; , \quad L[\re{E} \cdot \re{F}] = L[\re{E}] \cdot L[\re{E}] \; , \quad L[\re{E}^*] = {(L[\re{E}])}^*.
    \]
    We say that $\re{E}$ \emph{denotes} the language $L[\re{E}]$.
\end{defn}

We say that a language of $A^*$ is \emph{rational} if and only if it is denoted by a rational expression over $A$.

Two rational expressions are \emph{equivalent} if they denote the same language. That means $\re{E}$ and $\re{F}$ are equivalent if $L[\re{E}] = L[\re{F}]$ and we write it as $\re{E} \equiv \re{F}$.

\subsubsection*{Identities}

Let us state a few identities of rational expressions that will be often used without explicit mention.

\begin{lemma}\label{lm:expression_identities}
    \begin{gather*}
        (\re{E} + \re{F}) + \re{G} \equiv \re{E} + (\re{F} + \re{G}) \; , \quad \text{and} \quad (\re{E} \cdot \re{F}) \cdot \re{G} \equiv \re{E} \cdot (\re{F} \cdot \re{G}) \; ,\\[1ex]
        \re{E} + \re{F} \equiv \re{F} + \re{E} \; ,\\[1ex]
        \re{E} + \re{0} \equiv \re{0} + \re{E} \equiv \re{E} \; , \quad \re{E} \cdot \re{0} \equiv \re{0} \cdot \re{E} \equiv \re{0} \; , \quad \re{E} \cdot \re{1} \equiv \re{1} \cdot \re{E} \equiv \re{E} \; ,\\[1ex]
        \re{E} \cdot (\re{F} + \re{G}) \equiv \re{E} \cdot \re{F} + \re{E} \cdot \re{G} \; , \quad \text{and} \quad (\re{E} + \re{F}) \cdot \re{G} \equiv \re{E} \cdot \re{G} + \re{F} \cdot \re{G} \; .
    \end{gather*}
\end{lemma}

\begin{proof}
    \begin{align*}
        L[(\re{E} + \re{F}) + \re{G}] &= L[\re{E} + \re{F}] \cup L[\re{G}] = L[\re{E}] \cup L[\re{F}] \cup L[\re{G}] = L[\re{E}] \cup L[\re{F} + \re{G}] \\
        &= L[\re{E} + (\re{F} + \re{G})] \; , \\
        \\
        L[(\re{E} \cdot \re{F}) \cdot \re{G}] &= L[\re{E} \cdot \re{F}] \cdot L[\re{G}] = L[\re{E}] \cdot L[\re{F}] \cdot L[\re{G}] = L[\re{E}] \cdot L[\re{F} \cdot \re{G}] \\
        &= L[\re{E} \cdot (\re{F} \cdot \re{G})] \; , \\
        \\
        L[\re{E} + \re{F}] &= L[\re{E}] \cup L[\re{F}] = L[\re{F}] \cup L[\re{E}] = L[\re{F} + \re{E}] \; , \\
        \\
        L[\re{E} + \re{0}] &= L[\re{E}] \cup L[\re{0}] = L[\re{E}] = L[\re{0}] \cup L[\re{E}] = L[\re{0} + \re{E}] \; , \\
        \\
        L[\re{E} \cdot \re{0}] &= L[\re{E}] \cdot L[\re{0}] = L[\re{0}] = L[\re{0}] \cdot L[\re{E}] = L[\re{0} \cdot \re{E}] \; , \\
        \\
        L[\re{E} \cdot \re{1}] &= L[\re{E}] \cdot L[\re{1}] = L[\re{E}] = L[\re{1}] \cdot L[\re{E}] = L[\re{1} \cdot \re{E}] \; , \\
        \\
        L[\re{E} \cdot (\re{F} + \re{G})] &= L[\re{E}] \cdot L[\re{F} + \re{G}] = L[\re{E}] \cdot (L[\re{F}] \cup L[\re{G}]) = L[\re{E}] \cdot L[\re{F}] \cup L[\re{E}] \cdot L[\re{G}] \\
        &= L[\re{E} \cdot \re{F}] \cup L[\re{E} \cdot \re{G}] = L[\re{E} \cdot \re{F} + \re{E} \cdot \re{G}] \; , \\
        \\
        L[(\re{E} + \re{F}) \cdot \re{G}] &= L[\re{E} + \re{F}] \cdot L[\re{G}] = (L[\re{E}] \cup L[\re{F}]) \cdot L[\re{G}] = L[\re{E}] \cdot L[\re{G}] \cup L[\re{F}] \cdot L[\re{G}] \\
        &= L[\re{E} \cdot \re{G}] \cup L[\re{F} \cdot \re{G}] = L[\re{E} \cdot \re{G} + \re{F} \cdot \re{G}] \; .
    \end{align*}
\end{proof}

We also have
\[
    \re{0}^* \equiv \re{1} \; ,
\]
since
\[
    L[\re{0}^*] = \emptyset^* = \{ 1 \} = L[\re{1}] \; .
\]

\section{Star height}

The symbol $*$ defined for rational expressions is the only one that takes rational expression $\re{E}$ denoting a~finite language and gives rational expression denoting an~infinite language, $\re{E}^*$. Hence the idea of measuring the complexity of expressions by counting the number of nested uses of this symbol, a~number which is called the \emph{star height}, which we will write $\h{\re{E}}$, for $\re{E} \in \re{RatE} A^*$, and which is defined by induction:
\begin{align*}
    &\text{if } \re{E} = \re{0}, \re{E} = \re{1} \text{ or } \re{E} = a, \text{ for } a \in A \; , & &\h{\re{E}} = 0 \; , \\
    &\text{if } \re{E} = \re{F} + \re{G} \text{ or } \re{E} = \re{F} \cdot \re{G}\; , & &\h{\re{E}} = \max{(\h{\re{F}}, \h{\re{G}})} \; , \\
    &\text{if } \re{E} = \re{F}^* \; , & &\h{\re{E}} = 1 + \h{\re{F}} \; .
\end{align*}

The star height of rational language $L$ over $A^*$, written $\h{L}$, is the minimum of the star heights of the rational expressions that denote $L$:
\[
    \h{L} = \min \{ \h{\re{E}} \mid \re{E} \in \re{RatE} A^*: L = L[\re{E}] \} \; .
\]

\begin{lemma}\label{lm:star_height_distributivity}
    Every language $L$ over $A$ with star height~$h$ is denoted by a finite sum of rational expressions:
    \[
        L = L[ \re{E}_1 + \dotsb + \re{E}_n ] \; ,
    \]
    where each $\re{E}_j$ is a product of the form:
    \[
        \re{E}_j = u_0\re{F}_1^*u_1 \dotsm u_{m-1}\re{F}_m^*u_m,
    \]
    where each $u_k, 0 \leq k \leq m$, is a word in $A^*$ and each $\re{F}_k, 1 \leq k \leq m$, is a rational expression over $A$ of star height less then or equal to $h-1$.
\end{lemma}

\begin{proof}
    By induction on $h$, follows from the fact that product distributes over union.
\end{proof}

\section{Automata}

An automaton is a \emph{directed graph} which is \emph{labelled} with rational expressions over an alphabet, and in which two subsets of vertices are distinguished.

\begin{defn}
    An automaton $\aut{A}$ is specified by giving the following elements:
    \begin{itemize}
        \item[(i)] a non-empty set $Q$, called the set of \emph{states} of $\aut{A}$,
        \item[(ii)] a set $A$, also non-empty, called the \emph{(input) alphabet} of $\aut{A}$,
        \item[(iii)] a subset $I$ of $Q$, called the set of \emph{initial states}, of $\aut{A}$,
        \item[(iv)] a subset $T$ of $Q$, called the set of \emph{final states} of $\aut{A}$,
        \item[(v)] a subset $E$ of $Q \times \re{RatE} A^* \times Q$, called the set of \emph{transitions} of $\aut{A}$.
    \end{itemize}
    We write $\aut{A} = \langle Q, A, E, I, T \rangle$ and we say that $\aut{A}$ is \emph{an automaton over $A$}.
\end{defn}

Let $A$ be a finite alphabet. We call an automaton over $A$ \emph{finite} if set its states is finite.

If $e = (p, \re{E}, q)$ is a transition of $\aut{A}$, that is, if $e$ is in $E$, we say that $\re{E}$ is the \emph{label} of $e$ and we will write $p \tr{\re{E}} q$, or $p \tr[\aut{A}]{\re{E}} q$ where it might be ambiguous which automaton we are considering. We also say that $p$ is the \emph{source} and $q$ the \emph{destination} of the transition $e$. Transition is a \emph{loop}, if its source and destination are the same state. When transition has label $\re{1}$, it is called \emph{spontaneous}.

Note that we can always assume that there is, between each pair of states of an automaton, \emph{at most one transition}. This is because we chose rational expressions as the labels of transitions, rather than the usual letters of $A$. We make this generalisation to be able to represent any automaton by a single transition, as was shown to by possible by Kleene~\cite{Kleene56}. Similar generalisation was first introduced by Brzozowski and McCluskey~\cite{BrzozowskiMcCluskey64}.

When appropriate, we can even assume that there is, between each pair of states of an automaton, \emph{exactly one transition}, since if for some pair of states, there is no transition in the automaton, we can add a transition labelled with $\re{0}$.

A \emph{computation} in $\aut{A}$ is a sequence of transitions where the source of each transition is the destination of the previous one, which can be written as:
\[
    p_0 \tr{\re{E}_1} p_1 \tr{\re{E}_2} p_2 \tr{\re{E}_3} \dotsm \tr{\re{E}_{n-1}} p_{n-1} \tr{\re{E}_n} p_n,
\]
or
\[
    p_0 \tr{\re{E}_1 \re{E}_2 \dotsm \re{E}_n} p_n.
\]
We say that \emph{computation is in $\aut{A}$} if every transition of the computation is in $\aut{A}$. The state $p_0$ is the \emph{source} of the computation $c$, and $p_n$ its \emph{destination}. The \emph{length} of the computation $c$ is $n$, the number of transitions which make up $c$. The \emph{label} of $c$ is the product of the labels of the transitions of $c$. In the above case, the label of $c$ is $\re{E}_1 \re{E}_2 \dotsm \re{E}_n$.

A computation in $\aut{A}$ is \emph{successful} if its source is an initial state and its destination is a final state. A word in $A^*$ is called \emph{accepted} or \emph{recognised} by $\aut{A}$ if it is in a language denoted by a label of a successful computation in $\aut{A}$.

\begin{defn}
    The language accepted, or recognised by $\aut{A}$, written $L(\aut{A})$, is the set of words \emph{accepted} (or \emph{recognised}) by $\aut{A}$:
    \[
        L(\aut{A}) = \{ f \in A^* \mid \; \exists \: i \in I \: , \; \exists \: t \in T : \: i \tr[\aut{A}]{\re{E}} t \; \wedge \; f \in L[\re{E}] \}.
    \]
\end{defn}

Two automata are \emph{equivalent} if they recognise the same language. If $L$ is a language, and a finite automaton $\aut{A}$ exists such that $L = L(\aut{A})$, we call $L$ \emph{recognisable}.

\begin{lemma}\label{lm:block_star_lemma}
    Let $L$ be a recognisable language over $A$. There exists $N \in \N$ such that for every word $f$ in $L$ and every factorisation of the form $f = u v_1 v_2 \dotsm v_N w$, where every $v_i$ is a non-empty word, there is a pair $(j,k)$ of indices, $0 \leq j < k \leq N$, that
    \[
        u v_1 v_2 \dotsm v_j {(v_{j+1} \dotsm v_k)}^* v_{k+1} \dotsm v_N w \subseteq L.
    \]
\end{lemma}

\begin{proof}
    Let $\aut{A} = \langle Q, A, E, I, T \rangle$ be an automaton that recognises $L$. Set $N = |Q|$, meaning $N$ is a size of the set $Q$. A computation that accepts $f$ can be written
    \[
        i \tr{\re{E}} q_0 \tr{\re{F}_1} q_1 \tr{\re{F}_2} q_2 \tr{\re{F}_3} \dotsm \tr{\re{F}_{N-1}} q_{N-1} \tr{\re{F}_{N}} q_N \tr{\re{G}} t,
    \]
    where $u \in L[\re{E}], \; v_i \in L[\re{F}_i], $ for $ 1 \leq i \leq N$, and $w \in L[\re{G}]$. The $N + 1$ states $q_i$ cannot all be distinct, and at least two, say $q_j$ and $q_k$, are equal to the same state $p$. The computation can therefore be written
    \[
        i \tr{\re{E}} q_0 \tr{\re{F}_1 \re{F}_2 \dotsm \re{F}_j} p \tr{\re{F}_{j+1} \dotsm \re{F}_k} p \tr{\re{F}_{k+1} \dotsm \re{F}_N} q_N \tr{\re{G}} t,
    \]
    where $L[\re{F}_{j+1} \dotsm \re{F}_k]$ contains the non-empty word $v_{j+1} \dotsm v_k$. Hence, for every non-negative integer $n$,
    \[
        i \tr{\re{E}} q_0 \tr{\re{F}_1 \re{F}_2 \dotsm \re{F}_j} p \tr{{(\re{F}_{j+1} \dotsm \re{F}_k)}^n} p \tr{\re{F}_{k+1} \dotsm \re{F}_N} q_N \tr{\re{G}} t,
    \]
    is a successful computation of $\aut{A}$ and $u v_1 v_2 \dotsm v_j {(v_{j+1} \dotsm v_k)}^n v_{k+1} \dotsm v_N w$ is accepted by $\aut{A}$.
\end{proof}

\begin{defn}
    Automaton $\langle \Z_n, \{a,b\}, E, \{0\}, \{0\} \rangle$ is called \emph{ring automaton~${\aut{R}(n)}$}, if for each state $z \in \Z_n$ there are exactly two transitions with $z$ as a~source and they are $(z, a, z+1)$ and $(z, b, z-1)$.
\end{defn}

\begin{example}
    \autoref*{fig:automaton_R8} shows ring automaton~${\aut{R}(8)}$.

    \begin{figure}[h]
        \centering
        \input{./figures/automaton_R8}
        \caption{Automaton~${\aut{R}(8)}$}\label{fig:automaton_R8}
    \end{figure}
\end{example}

\begin{lemma}\label{lm:R_n_computation_existence}
    Let $\aut{R}(n)$ be a ring automaton. For any $m, r$, and $t$ in $\Z_n$, if the computation $r \tr{\re{H}} t$ is in $\aut{R}(n)$ then $r+m \tr{\re{H}} t+m$ is also in $\aut{R}(n)$.
\end{lemma}

\begin{proof}
    The computation $r \tr{\re{H}} t$ can be written as a sequence of transitions:
    \[
        r \tr{\re{X}_1} s_1 \tr{\re{X}_2} \dotsb \tr{\re{X}_{m-1}} s_{m-1} \tr{\re{X}_m} t \, ,
    \]
    where each $\re{X}_k$ is either a letter $a$ or $b$. Since, for any state $s \in \aut{R}(n)$, transitions $(s, a, s+1)$ and $(s, b, s-1)$ are in $\aut{R}(n)$, computation
    \begin{align*}
       r + 1 &\tr{\re{X}_1} s_1 + 1 \tr{\re{X}_2} \dotsb \tr{\re{X}_{m-1}} s_{m-1} + 1 \tr{\re{X}_m} t + 1 \\
    \intertext{is also in $\aut{R}(n)$. After $m$ iterations, we obtain a computation}
       r + m &\tr{\re{X}_1} s_1 + m \tr{\re{X}_2} \dotsb \tr{\re{X}_{m-1}} s_{m-1} + m \tr{\re{X}_m} t + m \, ,
    \end{align*}
    which can be written as $r+m \tr{\re{H}} t+m$.
\end{proof}

\subsubsection*{State removal algorithm}

\begin{lemma}\label{lm:state_removal_lemma}
    Let $\aut{A} = \langle Q, A, E, I, T \rangle$ be an~automaton with $n$ states which has at least one state that is neither initial nor accepting, that means $Q \setminus (I \cup T) \neq \emptyset$. An~automaton $\aut{B}$ with $n - 1$ states exists such that $L(\aut{B}) = L(\aut{A})$.
\end{lemma}

\begin{proof}
    Let $q$ be a~state in $Q \setminus (I \cup T)$. Next, we consider the transitions
    \[
        (p_1, \re{E}_1, q), \dotsc, (p_k, \re{E}_k, q), (q, \re{G}_1, r_1), \dotsc, (q, \re{G}_l, r_l), \text{ and } (q, \re{F}, q),
    \]
    where each $p_h \neq q$, and $r_j \neq q$. These are all the different transitions of $\aut{A}$ with $q$ as a destination, source, or both respectively. Note that $\re{F}$ may be $\re{1}$, since every state has at least spontaneous loop. To create the automaton $\aut{B}$, we remove all the mentioned transitions and the state $q$, and for each pair of states $(p_h, r_j)$, $1 \leq h \leq k$ and $1 \leq j \leq l$, we replace the transition $(p_h, \re{H}, r_j)$ with $(p_h, \re{H} + \re{E}_h\re{F}^*\re{G}_j, r_j)$. Note that $\re{H}$ may be $\re{0}$ for some state pairs.

    Now we verify that $L(\aut{B}) = L(\aut{A})$. Let $f$ be a~word accepted by $\aut{A}$. A~computation that accepts $f$ can be written as
    \[
        i \tr{\re{A}_1} s_1 \tr{\re{A}_2} s_2 \tr{\re{A}_3} \dotsm \tr{\re{A}_{N-1}} s_{N-1} \tr{\re{A}_N} t.
    \]
    If some $s_M = q$, there are non-negative integers $K$ and $L$ such that
    \[
        s_{M-K} = s_{M-K+1} = \dotsb = s_{M-1} = s_M = s_{M+1} = \dotsb = s_{M+L-1} = s_{M+L} = q,
    \]
    and the computation accepting $f$ is
    \[
        i \tr{\re{A}_1} \dotsm \tr{\re{A}_{M-K-1}} p_h \tr{\re{E}_h} q \tr{\overbrace{\scriptstyle \re{F} \dotsm \re{F}}^{\scriptstyle K+L \text{ times}}} q \tr{\re{G}_j} r_j \tr{\re{A}_{M+L+2}} \dotsm \tr{\re{A}_N} t,
    \]
    therefore a~factorisation of $f$ exists such that $f = u_1 u_2 v_1 \dotsm v_{K + L} w_1 w_2$, where $u_1 \in L[\re{A}_1 \dotsm \re{A}_{M-K-1}], u_2 \in L[\re{E}_h], v_1, \dotsc, v_{K+L} \in L[\re{F}], w_1 \in L[\re{G}_j], \text{ and } w_2 \in L[\re{A}_{M+L+2} \dotsm \re{A}_N]$. It follows that, for every non-negative integer $J$ and any words $g_1, \dotsc, g_J \in L[\re{F}]$, the word $u_1 u_2 g_1 \dotsm g_J w_1 w_2$ is also in $L(\aut{A})$. Specifically it is accepted by computations:
    \begin{align*}
        i \tr{\re{A}_1} \dotsm \tr{\re{A}_{M-K-1}} &p_h \tr{\re{E}_h} q \tr{\overbrace{\scriptstyle \re{F} \dotsm \re{F}}^{\scriptstyle J \text{ times}}} q \tr{\re{G}_j} r_j \tr{\re{A}_{M+L+2}} \dotsm \tr{\re{A}_N} t \; , \\
        i \tr{\re{A}_1} \dotsm \tr{\re{A}_{M-K-1}} &p_h \tr{\re{E}_h} q \tr{\re{F}^*} q \tr{\re{G}_j} r_j \tr{\re{A}_{M+L+2}} \dotsm \tr{\re{A}_N} t \; , \\
        i \tr{\re{A}_1} \dotsm \tr{\re{A}_{M-K-1}} &p_h \tr{\re{E}_h\re{F}^*\re{G}_j} r_j \tr{\re{A}_{M+L+2}} \dotsm \tr{\re{A}_N} t,
    \end{align*}
    but also by
    \[
        i \tr{\re{A}_1} \dotsm \tr{\re{A}_{M-1}} p_h \tr{\re{H} + \re{E}_h\re{F}^*\re{G}_j} r_j \tr{\re{A}_{M+L+2}} \dotsm \tr{\re{A}_N} t,
    \]
    which is a successful computation is $\aut{B}$ and therefore $f$ is accepted by $\aut{B}$.

    Otherwise, if every state $s_M \neq q$, but there are some states $s_M = p_h$ and $s_{M+1} = r_j$, then $f$ is accepted by a successful computation:
    \[
        i \tr{\re{A}_1} \dotsm \tr{\re{A}_M} p_h \tr{\re{H}} r_j \tr{\re{A}_{M+2}} \dotsm \tr{\re{A}_N} t,
    \]
    therefore $f$ is also accepted by $\aut{B}$, since
    \[
        i \tr{\re{A}_1} \dotsm \tr{\re{A}_M} p_h \tr{\re{H} + \re{E}_h\re{F}^*\re{G}_j} r_j \tr{\re{A}_{M+2}} \dotsm \tr{\re{A}_N} t
    \]
    is a successful computation in $\aut{B}$.

    If neither of the above cases are true, that means every $s_M \neq q$ and if any $s_M = p_h$ then $s_{M+1} \neq r_j$, the word $f$ is also accepted by
    \[
        i \tr[\aut{B}]{\re{A}_1} s_1 \tr[\aut{B}]{\re{A}_2} s_2 \tr[\aut{B}]{\re{A}_3} \dotsm \tr[\aut{B}]{\re{A}_{N-1}} s_{N-1} \tr[\aut{B}]{\re{A}_N} t,
    \]
    which is successful computation in $\aut{B}$, therefore $f \in L[\aut{B}]$.

    This shows that every word accepted by $\aut{A}$ is also accepted by $\aut{B}$.
\end{proof}

By iterating the removal of states in Lemma~\ref*{lm:state_removal_lemma} on $\aut{A} = \langle Q, A, E, I, T \rangle$, we can create an automaton with only $|I \cup T|$ states that accepts $L(\aut{A})$. It is important to note that depending on the order of the states chosen to be removed, we may obtain different automata.