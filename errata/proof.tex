%%% The main file. It contains definitions of basic parameters and includes all other parts.

%% Settings for single-side (simplex) printing
% Margins: left 40mm, right 25mm, top and bottom 25mm
% (but beware, LaTeX adds 1in implicitly)
\documentclass[12pt,a4paper]{report}
\setlength\textwidth{145mm}
\setlength\textheight{247mm}
\setlength\oddsidemargin{15mm}
\setlength\evensidemargin{15mm}
\setlength\topmargin{0mm}
\setlength\headsep{0mm}
\setlength\headheight{0mm}
% \openright makes the following text appear on a right-hand page
\let\openright=\clearpage

%% Settings for two-sided (duplex) printing
% \documentclass[12pt,a4paper,twoside,openright]{report}
% \setlength\textwidth{145mm}
% \setlength\textheight{247mm}
% \setlength\oddsidemargin{14.2mm}
% \setlength\evensidemargin{0mm}
% \setlength\topmargin{0mm}
% \setlength\headsep{0mm}
% \setlength\headheight{0mm}
% \let\openright=\cleardoublepage

%% Generate PDF/A-2u
\usepackage[a-2u]{pdfx}

%% Character encoding: usually latin2, cp1250 or utf8:
\usepackage[utf8]{inputenc}

%% Prefer Latin Modern fonts
\usepackage{lmodern}

%% Further useful packages (included in most LaTeX distributions)
\usepackage{amsmath}        % extensions for typesetting of math
\usepackage{amsfonts}       % math fonts
\usepackage{amsthm}         % theorems, definitions, etc.
\usepackage{amssymb}
\usepackage{bbding}         % various symbols (squares, asterisks, scissors, ...)
\usepackage{bm}             % boldface symbols (\bm)
\usepackage{graphicx}       % embedding of pictures
\usepackage{fancyvrb}       % improved verbatim environment
\usepackage{natbib}         % citation style AUTHOR (YEAR), or AUTHOR [NUMBER]
\usepackage[nottoc]{tocbibind} % makes sure that bibliography and the lists
			    % of figures/tables are included in the table
			    % of contents
\usepackage{dcolumn}        % improved alignment of table columns
\usepackage{booktabs}       % improved horizontal lines in tables
\usepackage{paralist}       % improved enumerate and itemize
\usepackage[usenames]{xcolor}  % typesetting in color

\usepackage{tikz}
\usetikzlibrary{automata}
\usetikzlibrary{positioning}
\usetikzlibrary{arrows}
\tikzset{my_automaton/.style={->,>=latex,semithick,bend angle=20}}
\tikzset{my_state/.style={circle, very thick, minimum size=0.4cm}}
\tikzset{my_named_state/.style={circle, thick, minimum size=0.7cm, inner sep=0.05cm}}
\tikzset{my_initial_state/.style={initial by arrow, initial text=}}
\tikzset{my_accepting_state/.style={accepting by double, thick}}

\usepackage{subfig}
\captionsetup{format=hang,margin=5pt}

\usepackage{etoolbox}

%% The hyperref package for clickable links in PDF and also for storing
%% metadata to PDF (including the table of contents).
%% Most settings are pre-set by the pdfx package.
\hypersetup{unicode}
\hypersetup{breaklinks=true}

% Definitions of macros (see description inside)
\input{../thesis/macros}

% Title page and various mandatory informational pages
\begin{document}

\begin{lemma}\label{lm:W_q_recognised_by_R2q}
    Language $W_q$ is recognised by an automaton~$\aut{R}(2^q)$.
\end{lemma}

\begin{proof}
    For each $k$, $0 \leq k \leq 2^q - 1$, we define two languages, $L_k$ and $S_k$, and we show that they are equal. Let $L_k$ be a~language of words that are labels of computations in $\aut{R}(2^q)$, that have $0$ as a~source and $k$ as a~destination. That is:
    \[
        L_k = \{ w \mid 0 \tr[\aut{R}(2^q)]{w} k \} \, .
    \]
    Since $0$ is the only final state of $\aut{R}(2^q)$, $L_0 = L[\aut{R}(2^q)]$. Let $S_k$ be a~language of words, that contain, modulo $2^q$, $k$ more $a$'s than $b$'s. That is:
    \[
        S_k = \{ w \mid |w|_a - |w|_b \equiv k \pmod{2^q} \} \, .
    \]
    From definition it is clear that $S_0 = W_q$. Let $w$ be a~word in ${\{a, b\}}^*$.

    Let $n$ be the length of $w$. By induction on $n$, we show that $w$ is in $L_k$ if and only if it is in $S_k$. For $n = 0$, $w = 1$. Since computation $0 \tr{1} 0$ is in $\aut{R}(2^q)$, $w$ is in $L_0$. Since $|w|_a - |w|_b \equiv 0 \pmod{2^q}$, $w$ is in $S_0$, which proves the base case of the induction. Given the induction hypothesis for some $n$, every word of length $n$, is in $L_k$ if and only if it is in $S_k$. Since transitions $(k, a, k+1)$ and $(k, b, k-1)$ are in $\aut{R}(2^q)$, computations $0 \tr{wa} k+1$ and $0 \tr{wb} k-1$ are in $\aut{R}(2^q)$, therefore $wa$ is in $L_{k+1}$, and $wb$ is in $L_{k-1}$. If $|w|_a - |w|_b \equiv k \pmod{2^q}$, then
    \[
        |wa|_a - |wa|_b \equiv k+1 \pmod{2^q} \qquad \text{and} \qquad |wb|_a - |wb|_b \equiv k-1 \pmod{2^q} \, ,
    \]
    therefore $wa$ is in $S_{k+1}$ and $wb$ is in $S_{k-1}$.
\end{proof}

\openright
\end{document}
